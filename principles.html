<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>gsm.app design principles • gsm.app</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="gsm.app design principles"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">gsm.app</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/plugins.html">Plugins</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Gilead-BioStats/gsm.app/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>gsm.app design principles</h1>
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm.app/blob/main/principles.md" class="external-link"><code>principles.md</code></a></small>
    </div>

<div id="gsmapp-design-principles" class="section level1">

<p><em>This is an experiment in making key package design principles explicit, versus only implicit in the code. The goal is to make maintenance easier, when spread out over time and across people. This idea was copied from <a href="https://github.com/r-lib/usethis/blob/main/principles.md" class="external-link">usethis</a>.</em></p>
<p><em>These principles are a work in progress.</em></p>
<div class="section level2">
<h2 id="argument-names-and-documentation">Argument names and documentation<a class="anchor" aria-label="anchor" href="#argument-names-and-documentation"></a></h2>
<ul><li>Function arguments should be prefixed with an abbreviation describing their expected class:
<ul><li>
<code>df</code> (eg: <code>dfBounds</code>) = data.frame</li>
<li>
<code>l</code> (eg: <code>lAssessment</code>) = list</li>
<li>
<code>str</code> (eg: <code>strMetricID</code>) = length-1 character vector</li>
<li>
<code>chr</code> (eg: <code>chrDomains</code>) = character vector (length &gt;= 1)</li>
</ul></li>
<li>The remainder of the argument name should use CamelCase.</li>
<li>If an argument is expected to be reactive (as in <code><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">shiny::reactive()</a></code>), it should be prefixed by <code>rctv_</code>, and then follow the rules above for the value <em>returned</em> by that reactive function. For example, a reactive expression that returns a MetricID string should be <code>rctv_strMetricID</code>.</li>
<li>If an argument is used more than once, document it in <code>R/aaa-shared.R</code>.
<ul><li>Within the function help, use <code>#' @inheritParams shared-params</code> to inherit globally defined parameters.</li>
<li>Arguments should be alphabetized in that document to make it easier to find whether they have already been documented.</li>
<li>Note: If a parameter is documented in a function, that definition will override the imported definition, even with <code>@inheritParams shared-params</code> (so it’s safe to use that pretty much everywhere).</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="minimize-reactivity">Minimize reactivity<a class="anchor" aria-label="anchor" href="#minimize-reactivity"></a></h2>
<p>If a function makes sense to be non-reactive, make it non-reactive. This applies even if the return is built out of HTML components, for example using <code>tagList()</code>. The module that calls the function can pass in an (evaluated) reactive expression to make the result reactive, but the function itself should be non-reactive whenever possible.</p>
</div>
<div class="section level2">
<h2 id="dont-namespace-shiny">Don’t namespace shiny<a class="anchor" aria-label="anchor" href="#dont-namespace-shiny"></a></h2>
<p>I’ve gone back and forth on this one, but the current rule is to skip namespace for {shiny} functions, particularly for basic HTML elements (reexported from {htmltools} by {shiny}). So <code>div()</code>, not <code><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">shiny::div()</a></code> nor <code><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">htmltools::div()</a></code> nor <code>htmltools::tag$div()</code>. Exceptions: roxygen documentation blocks and default arguments.</p>
<p>However, <em>do</em> use the namespace for anything in {htmltools} that isn’t reexported by {shiny}, such as <code><a href="https://rstudio.github.io/htmltools/reference/htmlDependency.html" class="external-link">htmltools::htmlDependency()</a></code>. This exception is why I’ve gone back and forth on this rule.</p>
</div>
<div class="section level2">
<h2 id="avoid-over-complicated-pipes">Avoid over-complicated pipes<a class="anchor" aria-label="anchor" href="#avoid-over-complicated-pipes"></a></h2>
<p>For simple variable selection and filtering, use base R. For example, instead of this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">colA</span> <span class="op">==</span> <span class="va">strA</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"colB"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">colB</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="st">"colB"</span><span class="op">)</span></span></code></pre></div>
<p>Use this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">colB</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">colA</span> <span class="op">==</span> <span class="va">strA</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This rule is still being formalized, so you will likely find places where code does not follow this rule, and we may change our minds.</p>
</div>
<div class="section level2">
<h2 id="modularize-everything">Modularize everything<a class="anchor" aria-label="anchor" href="#modularize-everything"></a></h2>
<p>Try to keep each function as short as it can be while still making sense. To accomplish this, break off logical pieces into functions (including shiny modules).</p>
<p>This rule applies even for code that is only used once. It is easier to follow this logic:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsm_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"GSM Deep Dive"</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="fu">uiSetStyle</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">mod_StudySummary_ui</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">mod_gsmNavset_ui</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Than this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsm_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>    <span class="fu">shinyjs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shinyjs/man/useShinyjs.html" class="external-link">useShinyjs</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    class <span class="op">=</span> <span class="st">"bg-light"</span>,</span>
<span>    style <span class="op">=</span> <span class="st">"min-height: 100vh;"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"GSM Deep Dive"</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/include.html" class="external-link">includeCSS</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"www"</span>, <span class="st">"styles.css"</span>, package <span class="op">=</span> <span class="st">"gsm.app"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">div</span><span class="op">(</span></span>
<span>      <span class="co"># etc</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">div</span><span class="op">(</span></span>
<span>      <span class="fu">div</span><span class="op">(</span></span>
<span>        <span class="fu">div</span><span class="op">(</span></span>
<span>          <span class="fu">div</span><span class="op">(</span></span>
<span>            <span class="fu">div</span><span class="op">(</span></span>
<span>              <span class="fu">div</span><span class="op">(</span></span>
<span>                <span class="co"># etc</span></span>
<span>              <span class="op">)</span>,</span>
<span>              <span class="fu">div</span><span class="op">(</span></span>
<span>                <span class="co"># etc</span></span>
<span>              <span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">div</span><span class="op">(</span></span>
<span>        <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/navset.html" class="external-link">navset_bar</a></span><span class="op">(</span></span>
<span>          <span class="co"># etc</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="single-mod-files">Single mod files<a class="anchor" aria-label="anchor" href="#single-mod-files"></a></h2>
<p>For modules, create one file: <code>mod_ModuleName.R</code>. We previously used separate <code>_UI.R</code> and <code>_Server.R</code> files, but it made it harder to update things than it needed to be.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jon Harmon, Spencer Childress, Taylor Rodgers, Matt Roumaya.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

